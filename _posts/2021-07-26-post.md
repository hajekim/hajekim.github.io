---
title: "Google Vertex AIë¡œ ì‹ ìš©ì¹´ë“œ ì´ìƒíƒì§€ AutoML ëª¨ë¸ ë§Œë“¤ê¸° 1/2"
date: 2021-07-26 18:00:00 +0900
categories: ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§
tags: [Google Cloud, ë¨¸ì‹ ëŸ¬ë‹]
---
> *** Google Vertex AI ê°„ë‹¨í•œ ì†Œê°œ ***
![](https://images.velog.io/images/haje/post/43164411-4675-4d98-acaa-ed84658341ba/1_aeXlwnOS3DvVHiMVgBZbpQ.png)
Google Cloudì˜ AI Platform, AutoML ë“± ë‹¤ì–‘í•œ ë¨¸ì‹ ëŸ¬ë‹ ì„œë¹„ìŠ¤ë¥¼ í•˜ë‚˜ì˜ ì¸í„°í˜ì´ìŠ¤(UI / API)ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ëœ ì¢…í•©ì„ ë¬¼ ê³¼ìì„¸íŠ¸ ê°™ì€ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.
ë°ì´í„°ì…‹ êµ¬ì„±ë¶€í„° ëª¨ë¸ ìƒì„±, í•™ìŠµ, í…ŒìŠ¤íŠ¸, ê²€ì¦í•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ Endpointë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë°°í¬ê¹Œì§€ í•˜ë‚˜ì˜ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ êµ¬ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤.
APIë¥¼ ì´ìš©í•˜ì—¬ Jupyter Notebookì—ì„œ êµ¬ì„±í•  ìˆ˜ë„ ìˆê³ , í´ë¼ìš°ë“œ ì—”ì§€ë‹ˆì–´ê°€ ì§ì ‘ UIì—ì„œ AutoMLì„ ì´ìš©í•˜ì—¬ ê°œë°œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

![](https://images.velog.io/images/haje/post/73bbfe6e-bdbb-4e38-ad9a-e6a62d97872d/image.png)

# Preface
Vertex AIë¥¼ ì‚¬ìš©í•˜ì—¬ Tabular ë°ì´í„°ë¡œ ëª¨ë¸ í›ˆë ¨ì„ í•´ë´…ì‹œë‹¤.
- Vertex AIì— ë°ì´í„°ì…‹ ì—…ë¡œë“œ
- AutoML ëª¨ë¸ í•™ìŠµ
- í•™ìŠµëœ AutoML ëª¨ë¸ì„ ì—”ë“œí¬ì¸íŠ¸ì— ë°°í¬ í›„, ì—”ë“œí¬ì¸íŠ¸ ì‚¬ìš© ì˜ˆì¸¡

## Pre Hands-On Requirements
- Google Cloud Platform ê³„ì • (Google ê³„ì •ìœ¼ë¡œ ë¬´ë£Œ í¬ë ˆë”§ì„ ë°›ì•„ë´…ì‹œë‹¤!)
- ~~ì•„ì£¼ ì•½ê°„ì˜ ë¨¸ì‹ ëŸ¬ë‹ ì§€ì‹~~
  - Imbalanced Data (ë¶ˆê· í˜• ë°ì´í„°)
  - Supervised Learning / Unsupervised Learning (ì§€ë„í•™ìŠµ/ë¹„ì§€ë„í•™ìŠµ)
  - Classification (ë¶„ë¥˜)
  - Label
- ~~ì•„ì£¼ ì•½ê°„ì˜ ì»´í“¨í„° ì‚¬ì´ì–¸ìŠ¤ ì§€ì‹~~
- ~~ì•„ì£¼ ì•½ê°„ì˜ í´ë¼ìš°ë“œ ì»´í“¨íŒ… ì§€ì‹~~

# Hands-On
## 1. GCP Console ì ‘ì†
![](https://images.velog.io/images/haje/post/d61d6591-5c04-4526-9188-a24491c855b6/01-masking.png)
Google Cloud Platformì— ë¡œê·¸ì¸í•˜ì—¬ Vertex AIë¥¼ ì‚¬ìš©í•  í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
ë³¸ ì˜ˆì‹œëŠ” **oreobox** í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

## 2. Vertex AI ì„¹ì…˜ìœ¼ë¡œ ì´ë™
![](https://images.velog.io/images/haje/post/a9b6a3e1-2dc4-4920-b747-d3101120313e/02.png)
ì¢Œì¸¡ ìƒë‹¨ì— í–„ë²„ê±° ë©”ë‰´ë¥¼ ì„ íƒí•˜ì—¬ **Vertex AI**ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.

## 3. Notebooks ìƒì„±
![](https://images.velog.io/images/haje/post/2d51d750-4723-4062-9cb1-4345b100eeb5/03.png)
Vertex AI ì„¹ì…˜ì—ì„œ Notebooksë¥¼ í´ë¦­í•©ë‹ˆë‹¤.

![](https://images.velog.io/images/haje/post/01564dbc-4189-43d4-b587-eafa2d5b15a3/04.png)
ì²˜ìŒ ë§Œë“ ë‹¤ë©´ ì•„ë¬´ê²ƒë„ ì—†ì„ ê±°ì—ìš”.
ìƒë‹¨ì— **New Instance**ë¥¼ í´ë¦­í•˜ì—¬ ë…¸íŠ¸ë¶ì„ ë§Œë“¤ì–´ ë´…ì‹œë‹¤.

![](https://images.velog.io/images/haje/post/bcd4d42c-995b-44f3-b1a9-2f0e594353c3/05.png)
ì•„ë˜ì— ìˆœì„œëŒ€ë¡œ ë“¤ì–´ê°€ì„œ ìƒì„±í•  ë…¸íŠ¸ë¶ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.
_TensorFlow Enterprise > TensorFlow Enterprise 2.3 (with LTS) > Without GPUs_

![](https://images.velog.io/images/haje/post/f63871be-5f7b-4c21-ad85-a494d348d7d7/06.png)
Instance nameì€ ê·€ì°®ì•„ì„œ ê·¸ëŒ€ë¡œ ë‘ê² ìŠµë‹ˆë‹¤. (ë³€ê²½í•˜ê³  ì‹¶ìœ¼ì‹œë©´ ë³€ê²½í•˜ì„¸ìš”!)
í…ŒìŠ¤íŠ¸ì´ê¸° ë•Œë¬¸ì— ê°€ì¥ ì €ë ´í•œ ë¦¬ì „ì¸ Iowa(us-central1)ì„ ì„ íƒí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
ì‚¬ì¡±ì´ì§€ë§Œ Seoulì€ ì œë²• ë¹„ìŒ‰ë‹ˆë‹¤. ~~(í¬ìœ¼ êµ­ë½•ì— ì·¨í•œë‹¤)~~

Subnetì€ defaultë¥¼ ì‚¬ìš©í•˜ê³  CREATE í´ë¦­.

## 4. ë°ì´í„°ì…‹ ìƒì„±

ëª¨ë¸ í›ˆë ¨ì— ì‚¬ìš©í•  ë°ì´í„°ëŠ” Kaggleì˜ [ì‹ ìš©ì¹´ë“œ ì‚¬ê¸° íƒì§€ ë°ì´í„°ì…‹(Credit Card Fraud Detection)](https://www.kaggle.com/mlg-ulb/creditcardfraud)ì„ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë°”ë¡œ ê°€ì ¸ì™€ì„œ ì‚¬ìš©í•˜ì§€ ì•Šê³  BigQueryì—ì„œ Public Datasetìœ¼ë¡œ ì œê³µë˜ëŠ” ë²„ì „ìœ¼ë¡œ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.

>ë§ì€ ì‚¬ê¸° íƒì§€ ë° ì´ìƒ íƒì§€ ë¬¸ì œì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ **ë°ì´í„°ì„¸íŠ¸ê°€ ë¶ˆê· í˜•(Imbalaced Dataset)**í•©ë‹ˆë‹¤. ë‹¤í–‰íˆ(?) ìš°ë¦¬ê°€ ì‚¬ëŠ” ê³³ì€ ê³ ë‹´ ì‹œí‹°ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì •ìƒì ì¸ ê±°ë˜ê°€ ë¹„ì •ìƒì ì¸ ê±°ë˜ë³´ë‹¤ í›¨ì”¬ ë§ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë³¸ ì‹¤ìŠµì—ì„œëŠ” ë¶ˆê· í˜• ë°ì´í„° ì„¸íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ëª‡ ê°€ì§€ íŒì„ ì œê³µí•©ë‹ˆë‹¤.


![](https://images.velog.io/images/haje/post/584dba1d-3f73-44b2-955a-09f65419eeab/07.png)
Vertex AI ì„¹ì…˜ì—ì„œ Datasetsì„ í´ë¦­í•©ë‹ˆë‹¤.

![](https://images.velog.io/images/haje/post/e10774e0-5ad8-404a-ad3d-683f014ae4cf/08.png)
ìƒë‹¨ì— CREATEë¥¼ í´ë¦­í•©ë‹ˆë‹¤.

![](https://images.velog.io/images/haje/post/a6e13be1-dbc7-4690-b89b-1c4af5bfaabd/09.png)
ë°ì´í„°ì…‹ ì´ë¦„ì€ fraud_detectionìœ¼ë¡œ ì…ë ¥í•˜ê² ìŠµë‹ˆë‹¤.

![](https://images.velog.io/images/haje/post/a7f63469-5604-463f-8972-9418896a4cb7/10.png)
Tabularë¡œ ë³€ê²½í•œ í›„ì— Regression/Classificationì„ ì„ íƒ í›„ ìƒì„±í•©ë‹ˆë‹¤.

![](https://images.velog.io/images/haje/post/ddfb3d04-eb62-405f-b867-77870a8e1efe/11.png)
ë°©ê¸ˆ ë§Œë“  fraud_detection ë°ì´í„°ì…‹ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ë¹ˆ ê¹¡í†µì´ë‹ˆê¹Œ ë°ì´í„°ë¥¼ ì±„ì›Œì¤ì‹œë‹¤.
fraud_detectionì„ í´ë¦­í•©ë‹ˆë‹¤.

![](https://images.velog.io/images/haje/post/66263d27-15cf-43d0-93aa-73527413eaf0/12.png)
BigQueryì—ì„œ ë°ì´í„°ì…‹ì„ ê°€ì ¸ì˜¤ê¸°ë¡œ í–ˆìœ¼ë‹ˆê¹Œ data source ì˜µì…˜ì„ ë³€ê²½í•©ë‹ˆë‹¤.
- Select a table or view from BigQuery


![](https://images.velog.io/images/haje/post/67d59a85-c9f6-49cd-89c8-bf5d1cdc5b07/13.png)
ê·¸ ë‹¤ìŒ ê°€ì ¸ì˜¬ BigQuery Tableì„ ì•„ë˜ ë‚´ìš©ì„ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ìŠµë‹ˆë‹¤.
```
bigquery-public-data.ml_datasets.ulb_fraud_detection
```

![](https://images.velog.io/images/haje/post/013de21d-4a31-4d13-8ab7-7de2de184b70/14.png)
ì •ìƒì ìœ¼ë¡œ ë°ì´í„°ì…‹ì„ ê°€ì ¸ì™”ë‹¤ë©´ ìœ„ì™€ ê°™ì´ ê°™ì´ í‘œì‹œë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
ë°ì´í„°ì…‹ì€ ì‹¤ì œ ì‹ ìš©ì¹´ë“œ ê±°ë˜ ì •ë³´ì´ê¸° ë•Œë¬¸ì— í”¼ì³ ëª…ì¹­ì€ V1, V2 ë“±ìœ¼ë¡œ ë¶ˆëª…í™•í•œ ì •ë³´ë¡œ ë§ˆìŠ¤í‚¹ë˜ì–´ ìˆìŠµë‹ˆë‹¤.


## 5. ëª¨ë¸ ìƒì„±í•˜ê¸°
ë°ì´í„°ì…‹ì´ ì¤€ë¹„ë˜ì—ˆìœ¼ë‹ˆ í›ˆë ¨ì„ ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤.
íŠ¹ì • ê±°ë˜ê°€ ì‚¬ê¸°ì¸ì§€ ì•„ë‹Œì§€ ì˜ˆì¸¡í•˜ê¸° ìœ„í•´ Classification í›ˆë ¨ì„ í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ëª¨ë¸ ì˜µì…˜ì€ ë‘ ê°€ì§€ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

- AutoML : ì½”ë“œ ì‘ì„± ì—†ì´ Vertex AIê°€ ì œì‹œí•˜ëŠ” Best Modelì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
- Custom Training : ë‚´ê°€ ì‘ì„±í•œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•

![](https://images.velog.io/images/haje/post/540fb70e-b2e0-4c88-8c4f-a2000922e050/16.png)
Train new modelì„ í´ë¦­í•˜ì—¬ ëª¨ë¸ ìƒì„±ì„ í•´ë´…ì‹œë‹¤.
ì•„ì‰½ê²Œë„ ì¸í”„ë¼ìŸì´ê°€ ë§Œë“  ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì´ Google AutoMLë³´ë‹¤ ë›°ì–´ë‚  ê±°ë¼ ê¸°ëŒ€ê°€ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤â€¦.ğŸ˜­
AutoMLì„ í´ë¦­í•˜ì—¬ ìµœì†Œí•œì˜ ë…¸ë ¥ìœ¼ë¡œ ëª¨ë¸ì„ ìƒì„±í•´ë³´ê² ìŠµë‹ˆë‹¤ã…‹ã…‹

![](https://images.velog.io/images/haje/post/e02c3585-9dad-4e7f-8d38-1987d9e6a063/17.png)
ë¶„ë¥˜í•  ëŒ€ìƒì„ ì…ë ¥í•©ë‹ˆë‹¤.
- Class (INTEGER)

![](https://images.velog.io/images/haje/post/60901e30-d89b-47fd-84a9-19ef0b2f3e98/18.png)
ADVANCED OPTIONSë¥¼ ëˆŒëŸ¬ë³´ë©´ Data Split ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤.
ê·¸ëƒ¥ ë‚´ë¹„ë‘¡ì‹œë‹¤!

![](https://images.velog.io/images/haje/post/ddcc2d8e-9ef7-4bec-a7cd-fe23e2321689/19.png)
ë°ì´í„°ì…‹ì˜ ëª¨ë“  í”¼ì³ê°€ ì£¼ë¥´ë¥µ ì¶œë ¥ì´ ë©ë‹ˆë‹¤.
ë­ê°€ ì´ë¦¬ ë§ì•„!! ë†€ë¼ì§€ ë§ˆì‹œê³  ì•„ë˜ ADVANCED OPTIONSë¥¼ ëˆŒëŸ¬ì¤ë‹ˆë‹¤.

![](https://images.velog.io/images/haje/post/82b5361d-aa2e-4872-95da-187d3ddd52cb/20.png)
ìµœì í™” ëª©í‘œ(Optimization objective)ë¥¼ ë³€ê²½í•˜ê² ìŠµë‹ˆë‹¤.
ë¶ˆê· í˜• ë°ì´í„°ì…‹ì´ë¯€ë¡œ ì´ë•Œ ê¸°ê°€ ë§‰íŒ ê²€ì¦ ë°©ë²•ì¸ **AUC PRC**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
ë¶ˆê· í˜• ë°ì´í„°ì— AUC-PR(Precision-Recall)ì„ ì´ìš©í•  ë•Œ ë” ì¢‹ì€ ê²°ê³¼ë¥¼ ì–»ì—ˆë‹¤ëŠ” ë…¼ë¬¸ë“¤ì´ ì°¾ì•„ë³´ë‹ˆ ê½¤ ìˆìŠµë‹ˆë‹¤.
_ì°¸ê³ ë…¼ë¬¸: [Helen R. Sofaer, Jennifer A. Hoeting, Catherine S. Jarnevich, (17 December 2018). The area under the precision-recall curve as a performance metric for rare binary events](https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.13140)_

![](https://images.velog.io/images/haje/post/61390845-eb58-4674-8e44-f64587b052e9/21.png)
ë…¸ë“œ ì‹œê°„ ìˆ˜ëŠ” 1ë¡œ ì…ë ¥í•©ë‹ˆë‹¤.
AutoML ëª¨ë¸ì„ ì»´í“¨íŒ… 1ì‹œê°„ ë™ì•ˆ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
ì €ëŠ” ë¬´ë£Œ í¬ë ˆë”§ìœ¼ë¡œ ì´ í¬ìŠ¤íŒ…ì„ í•˜ê³  ìˆëŠ” ì†Œì‹œë¯¼ì´ë¯€ë¡œ í¬ë ˆë”§ì„ ì•„ë‚ì‹œë‹¤!
Budgetì€ ìµœì†Œê°’ì¸ 1ë¡œ ì…ë ¥í•©ë‹ˆë‹¤ğŸ™Œ


![](https://images.velog.io/images/haje/post/94d2602b-f427-4ad4-aaec-5273b54a0b75/22.png)
1ì‹œê°„ ë™ì•ˆ ê¸°ë‹¤ë ¤ë´…ì‹œë‹¤.

ë‹¤ìŒ ë‚´ìš©ì€ 2í¸ì—ì„œâ€¦!


# ì°¸ê³ ë¬¸ì„œ
- [Vertex AI:Building a fraud detection model with AutoML](https://codelabs.developers.google.com/vertex-automl-tabular)
- [Vertex AI ì†Œê°œ](https://cloud.google.com/vertex-ai/docs/start/introduction-unified-platform?hl=ko)